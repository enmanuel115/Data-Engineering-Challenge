
ALTER DATABASE test
ADD FILEGROUP FG_01_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_02_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_03_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_04_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_05_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_06_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_07_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_08_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_09_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_10_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_11_2022
GO
ALTER DATABASE test
ADD FILEGROUP FG_12_2022
GO;

ALTER DATABASE test
ADD FILE
(
  NAME = [File_012022],
  FILENAME = 'D:\test\File_012022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_01_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_022022],
  FILENAME = 'D:\test\File_022022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_02_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_032022],
  FILENAME = 'D:\test\File_032022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_03_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_042022],
  FILENAME = 'D:\test\File_042022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_04_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_052022],
  FILENAME = 'D:\test\File_052022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_05_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_062022],
  FILENAME = 'D:\test\File_062022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_06_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_072022],
  FILENAME = 'D:\test\File_072022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_07_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_082022],
  FILENAME = 'D:\test\File_082022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_08_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_092022],
  FILENAME = 'D:\test\File_092022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_09_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_102022],
  FILENAME = 'D:\test\File_102022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_10_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_112022],
  FILENAME = 'D:\test\File_112022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_11_2022
GO
 
ALTER DATABASE test
ADD FILE
(
  NAME = [File_122022],
  FILENAME = 'D:\test\File_122022.ndf',
    SIZE = 5 MB,  
    MAXSIZE = UNLIMITED, 
    FILEGROWTH = 10 MB
) TO FILEGROUP FG_12_2022
GO;

USE test
GO
CREATE PARTITION FUNCTION [PF_MonthlyPartition] (DATETIME)
AS RANGE RIGHT FOR VALUES 
(
  '2022-01-31 23:59:59.997', '2022-02-28 23:59:59.997', '2022-03-31 23:59:59.997', 
  '2022-04-30 23:59:59.997', '2022-05-31 23:59:59.997', '2022-06-30 23:59:59.997', 
  '2022-07-31 23:59:59.997', '2022-08-31 23:59:59.997', '2022-09-30 23:59:59.997', 
  '2022-10-31 23:59:59.997', '2022-11-30 23:59:59.997', '2022-12-31 23:59:59.997'
);

USE test
GO
CREATE PARTITION SCHEME PS_MonthWise
AS PARTITION PF_MonthlyPartition
TO 
( 
  'FG_01_2022', 'FG_02_2022', 'FG_03_2022',
  'FG_04_2022', 'FG_05_2022', 'FG_06_2022', 
  'FG_07_2022', 'FG_08_2022', 'FG_09_2022', 
  'FG_10_2022', 'FG_11_2022', 'FG_12_2022',
  'Primary'
);


USE test
CREATE TABLE trips (
			trip_id int primary key IDENTITY(1,1) not null,
			region nvarchar(50),
			priorigin_coord geography,
            destination_coord geography,
            datetime datetime,
            datasource nvarchar(50)
) ON PS_MonthWise ([datetime])

GO
CREATE CLUSTERED INDEX CI_trip_id ON test(trip_id)